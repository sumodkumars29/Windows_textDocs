:: Move files older than X days:

forfiles /p "C:\SourceFolder" /s /m *.* /d -30 /c "cmd /c move @path \"D:\TargetFolder\""

:: /p "C:\SourceFolder" - Path to search
:: /s - Include subdirectories
:: /m *.* - File mask (all files)
:: /d -30 - Files older than 30 days
:: /c "cmd /c move @path \"D:\TargetFolder\"" - Command to execute

	:: Outer /c = forfiles switch (defines what to execute).
	:: -> /c "command" --> tells forfiles what command to run for each matched file.

	:: Inner /c = cmd.exe switch (executes move or del and then exits).
	::  -> cmd /c <string> --> means "run the given command string and then terminate".
	:: If you removed the inner /c, it would just open a new Command Prompt window and do nothing, because cmd wouldn‚Äôt know what to execute.

:: Delete files older than X days:

forfiles /p "C:\SourceFolder" /s /m *.* /d -90 /c "cmd /c del @path"

:: /d -90 - Files older than 90 days


:: Move files newer than X days:

forfiles /p "C:\SourceFolder" /s /m *.* /d +7 /c "cmd /c move @path \"D:\TargetFolder\""

:: /d +7 - Files newer than 7 days

forfiles /p "%USERPROFILE%\Downloads" /m *.* /d -1 /c "cmd /c del @path"

:: /d -1 - Files older than today

:: Before running deletion, test it by listing what would be deleted:

forfiles /p . /m *.* /d -1 /c "cmd /c echo @path"

:: If the output looks correct, then re-run your original command to delete.

forfiles /p . /m *.* /d -1 /c "cmd /c del @path"

:: delete matching files inside subfolders too
forfiles /p . /s /m *.* /d -1 /c "cmd /c del @path"


:: Skip certain file types (e.g., keep .jpg or .exe files)
:: Forfiles can only include, not exclude, directly so use a small logic tweak inside the cmd /c part.

forfiles /p . /s /m *.* /d -1 /c "cmd /c if /I not \"@ext\"==\".jpg\" if /I not \"@ext\"==\".exe\" del @path"

:: to delete only directories
forfiles /p "%USERPROFILE%\Downloads" /s /d -1 /c "cmd /c if @isdir==TRUE rd /s /q @path"

forfiles /p "%USERPROFILE%\Downloads" /s /m "*" /d -1 /c "cmd /c attrib -r -h -s @path & if @isdir==FALSE del /f /q @path"
forfiles /p "%USERPROFILE%\Downloads" /s /d -1 /c "cmd /c if @isdir==TRUE attrib -r -h -s @path & rd /s /q @path"

attrib -r -h -s @path ‚Üí removes Read-only, Hidden, and System attributes.
if @isdir==FALSE del /f /q @path ‚Üí force-deletes files quietly.
if @isdir==TRUE rd /s /q @path ‚Üí removes folders and their contents quietly.
/d -1 ‚Üí targets items modified more than 1 day ago.

:: delete directories (or files) matching a pattern and optionally older than a certain number of days

	forfiles /p "C:\Users\S10DIGITAL\Downloads" /d -0 /m "Pic*" /c "cmd /c if @isdir==TRUE rd /s /q @path"

	forfiles /p "C:\Users\S10DIGITAL\Downloads" /s /d -1 /m "*" /c "cmd /c if @isdir==TRUE rd /s /q @path"

:: delete all directories and files and older than today	
forfiles /p "%USERPROFILE%\Downloads" /s /m "*" /d -1 /c "cmd /c if @isdir==TRUE (rd /s /q @path 2>nul) else (del /f /q @path 2>nul)"

forfiles /p "%USERPROFILE%\Downloads" /s /m "*" /d -1 /c "cmd /c if @isdir==TRUE (rd /s /q \"@path\" 2>nul) else (del /f /q \"@path\" 2>nul)"


:: /p "C:\Users\S10DIGITAL\Downloads" ‚Üí the path where you want to look.
:: /s ‚Üí include all subfolders
:: /d -0 ‚Üí selects items with last modified date 0 days ago or older (basically all). You can change -0 to -1, -2, etc., to target older directories.
:: /m "Pic*" ‚Üí the pattern to match. Here it matches all folders starting with Pic. Use "*" to target all directories.
:: /c "cmd /c if @isdir==TRUE rd /s /q @path" ‚Üí the command to execute:
:: if @isdir==TRUE ‚Üí check if it‚Äôs a folder or file
:: if @isdir==TRUE (...) else (...) ‚Üí check if it‚Äôs a folder or file
:: @isdir==TRUE ensures it only deletes directories, not files.
:: rd /s /q @path recursively and quietly removes the directory.
:: del /f /q @path ‚Üí delete files quietly
:: 2>nul redirects all error output (stderr) to nowhere




üîç Breakdown

/p . ‚Üí start from the current directory
/s ‚Üí include subfolders
/m *.* ‚Üí target all files
/d -1 ‚Üí only files older than 1 day
/c "cmd /c if /I not \"@ext\"==\".jpg\" if /I not \"@ext\"==\".exe\" del @path"
@ext ‚Üí the file‚Äôs extension (e.g., .jpg, .exe)
if /I not ‚Üí case-insensitive ‚Äúnot equal‚Äù comparison
Only deletes if extension is not .jpg and is not .exe

************************************************************************************************
cmd help info: forfiles /?

FORFILES [/P pathname] [/M searchmask] [/S]
         [/C command] [/D [+ | -] {dd-MM-yyyy | dd}]

Description:
    Selects a file (or set of files) and executes a
    command on that file. This is helpful for batch jobs.

Parameter List:
    /P    pathname      Indicates the path to start searching.
                        The default folder is the current working
                        directory (.).

    /M    searchmask    Searches files according to a searchmask.
                        The default searchmask is '*' .

    /S                  Instructs forfiles to recurse into
                        subdirectories. Like "DIR /S".

    /C    command       Indicates the command to execute for each file.
                        Command strings should be wrapped in double
                        quotes.

                        The default command is "cmd /c echo @file".

                        The following variables can be used in the
                        command string:
                        @file    - returns the name of the file.
                        @fname   - returns the file name without
                                   extension.
                        @ext     - returns only the extension of the
                                   file.
                        @path    - returns the full path of the file.
                        @relpath - returns the relative path of the
                                   file.
                        @isdir   - returns "TRUE" if a file type is
                                   a directory, and "FALSE" for files.
                        @fsize   - returns the size of the file in
                                   bytes.
                        @fdate   - returns the last modified date of the
                                   file.
                        @ftime   - returns the last modified time of the
                                   file.

                        To include special characters in the command
                        line, use the hexadecimal code for the character
                        in 0xHH format (ex. 0x09 for tab). Internal
                        CMD.exe commands should be preceded with
                        "cmd /c".

    /D    date          Selects files with a last modified date greater
                        than or equal to (+), or less than or equal to
                        (-), the specified date using the
                        "dd-MM-yyyy" format; or selects files with a
                        last modified date greater than or equal to (+)
                        the current date plus "dd" days, or less than or
                        equal to (-) the current date minus "dd" days. A
                        valid "dd" number of days can be any number in
                        the range of 0 - 32768.
                        "+" is taken as default sign if not specified.

    /?                  Displays this help message.

Examples:
    FORFILES /?
    FORFILES
    FORFILES /P C:\WINDOWS /S /M DNS*.*
    FORFILES /S /M *.txt /C "cmd /c type @file | more"
    FORFILES /P C:\ /S /M *.bat
    FORFILES /D -30 /M *.exe
             /C "cmd /c echo @path 0x09 was changed 30 days ago"
    FORFILES /D 01-01-2001
             /C "cmd /c echo @fname is new since Jan 1st 2001"
    FORFILES /D +24-9-2025 /C "cmd /c echo @fname is new today"
    FORFILES /M *.exe /D +1
    FORFILES /S /M *.doc /C "cmd /c echo @fsize"
    FORFILES /M *.txt /C "cmd /c if @isdir==FALSE notepad.exe @file"